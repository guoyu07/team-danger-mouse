<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Hello, World! • A-Frame</title>
    <meta name="description" content="Hello, World! • A-Frame">
    <script src="https://aframe.io/releases/0.2.0/aframe.min.js"></script>
  </head>
  <body>
    <a-scene>

        <a-entity camera look-controls position="0 0 10" >
          <a-entity cursor="fuse: true; maxDistance: 30; timeout: 5"
              position="0 0 -5"
              geometry="primitive: ring"
              material="color: white; shader: flat">

              <!-- <a-animation begin="click" easing="ease-in" attribute="scale"
                  fill="backwards" from="0.1 0.1 0.1" to="1 1 1"></a-animation> -->
              <a-animation begin="fusing" easing="ease-in" attribute="scale"
                  fill="forwards" from="1 1 1" to="0.1 0.1 0.1"></a-animation>
          </a-entity>

        </a-entity>

      <a-sphere data-key="a4" position="4 1.25 -3" radius="1.25" color="#EF2D5E"></a-sphere>
      <a-sphere data-key="c4" position="5 2.25 -5" radius="1.25" color="#EF2D5E"></a-sphere>
      <a-sphere data-key="d4" position="3 4.25 10" radius="1.25" color="#EF2D5E"></a-sphere>
      <a-sphere data-key="e4" position="8 3.25 -10" radius="1.25" color="#EF2D5E"></a-sphere>
      <a-sphere data-key="f4" position="8 4.25 4" radius="1.25" color="#EF2D5E"></a-sphere>
      <a-sphere data-key="g4" position="9 8.25 2.5" radius="1.25" color="#EF2D5E"></a-sphere>
      <a-sphere data-key="g4" position="9 8.25 2.5" radius="1.25" color="#EF2D5E"></a-sphere>

      <!-- https://www.flickr.com/photos/vitroids/3033329561/in/photolist-Gj57k-5C3Bcx-jk1Byv-36uUj9-52ftoS-7rStBS -->
      <a-sky src="vrsky.jpg" rotation="0 -130 0"></a-sky>
    </a-scene>
    <script src="https://js.pusher.com/3.2/pusher.min.js"></script>
    <script type="text/javascript">

      var pusher = new Pusher('cfbbdd53d88cd46a7deb', {
        encrypted: true,
        authEndpoint: 'https://www.barrucadu.co.uk/dangermouse/'
      })

      var channel = pusher.subscribe('presence-music')

      ;[].forEach.call(document.querySelectorAll('a-sphere'), function(sphere){
        sphere.addEventListener('click', function(){
          console.log("click", sphere, sphere.dataset.key)
          channel.trigger('client-do', [{play: ':' + sphere.dataset.key}])
        }, false)
      });
    </script>
  </body>
</html>
